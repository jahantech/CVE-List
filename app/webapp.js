var express = require('express');
var bodyParser = require('body-parser');
var PORT = 8080;
var app = express();
var mysql = require('mysql');


app.use(bodyParser.urlencoded({
        extended: false
}));

app.use(bodyParser.json());
app.use('/', express.static('static'));
app.get('/list', function(req, res) {
var connection = mysql.createConnection({
	host     : '127.0.0.1',
	user     : 'root',
	password : '',
	database : 'vulner_stats'
});
	connection.connect();

	connection.query('SELECT vuln_id, vuln_pub_date, vuln_score, vuln_products, vuln_summary from vulnerabilities order by vuln_pub_date DESC', function(err, rows, fields) {
		if (err){
			throw err;
		}
		connection.end();
		res.json(rows);
	});
});


app.listen(PORT);
console.log('Server is Listening at:' + PORT);
