var express = require('express');
var bodyParser = require('body-parser');
var PORT = 80;
var app = express();
var mysql = require('mysql');

var connection = mysql.createConnection({
  host     : '127.0.0.1',
  user     : 'root',
  password : '',
  database : 'vulner_stats'
});

app.use(bodyParser.urlencoded({
        extended: false
}));

app.use(bodyParser.json());

app.get('/', function(req, res) {
	connection.connect();

	connection.query('SELECT vuln_id, vuln_pub_date, vuln_score, vuln_products, vuln_summary from vulnerabilities', function(err, rows, fields) {
		if (err){
			throw err;
		}
		res.json(rows);
	});
});


app.listen(PORT);
console.log('Server is Listening at:' + PORT);
